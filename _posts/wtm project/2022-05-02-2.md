---
title:  "wtm 프로젝트 웹스크래핑"
excerpt: "프로젝트"

toc: true
toc_sticky: true
toc_label: "TOC"

categories:
  - project
last_modified_at: 2022-05-02T12:00:00-50:00
---

## 식단표 페이지 분석
학교의 식단표 페이지에는 일주일간의 식단이 표로 식단을 표기하였고 표의 오른쪽 위에 날짜를 선택할 수 있어 선택한 날짜에 해당하는 주에 대한 식단표가 나오는 방식이다.
처음 보았을 때 크게 대강 두 부분으로 나누어 어떻게 할지 고민해보기로 하였다.  
### 날짜를 선택하는 부분
표의 오른쪽 위에 날짜를 선택할 수 있어 선택값에 따라 get방식을 이용하여 sdate=20220509와 같은 날짜를 요청하여 받아오는 방식으로 작동한다.  
해당 부분을 수정해야하나 싶었지만 sdata를 주소에 명시하지 않아도 자동으로 이번주에 해당하는 식단표가 나오는 것을 확인하여 큰 문제없이 원래의 주소를 사용함으로써 해결할 수 있었다.
### 식단표 구성
식단표는 표로 구성되어 있고 표 속의 행이 아침, 점심, 저녁으로 열이 날짜로 구분된 표로 구성되어 있다.  
간단하게 table태그를 스크래핑하여 가공하면 일주일간의 식단내용을 가져올 수 있다고 생각하였다.

## 구현
python의 requests, BeautifulSoup를 이용하여 구현하였다.  
http요청을 보내기 위해 requests, 해당 소스에서 원하는 내용을 추출하기위해 BeautifulSoup를 사용하였다.

해당 내용을 스크래핑하기위해 해당 소스를 보았는데 페이지는 식당운영시간, 식단표 두개의 표로 구성되어 있고 두 표 모두 같은 ctable 클래스로 되어있어 어떻게 해당 태그의 내용을 가져올지 많은 고민을 하였다. 같은 태그에 같은 클래스로 구성되어 쉽게 BeautifulSoup로 바로 구분하기 어려웠다. 따라서 간단하게 table태그를 find_all로 모두 가져와 두번째(리스트)의 표를 지정하여 가져오는 방법을 사용하였다.  

이후 테이블 내의 td태그 사이 내용들을 모두 가져온 후 해당내용을 아침, 점심, 저녁으로 구분하고 또 메뉴별로 구분하여 리스트로 정리하였다.  

## 코드
<script src="https://gist.github.com/an-jiohh/3683f0567a1490bf47b7d59596710936.js"></script>